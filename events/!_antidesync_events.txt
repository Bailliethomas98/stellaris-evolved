# events\!_antidesync_events.txt

namespace = antidesync_evolved

# scope: country, from: leader
#on_added_to_leader_pool

country_event = {
	id = antidesync_evolved.1
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		always = yes
	}

	immediate = {
		from = {
			save_event_target_as = tec_temp_leader
			# Changes ethic to gestalt to normalize
			change_background_ethic = ethic_gestalt_consciousness
			# We sample from the population of the species and apply an ethic
			creator = {
				random_owned_pop = {
					limit = {
						is_exact_same_species = event_target:tec_temp_leader
						NOR = {
							has_trait = trait_mechanical
							has_trait = trait_tec_bioservant
							has_trait = trait_zombie
							has_trait = trait_nerve_stapled
							has_trait = trait_presapient_proles
							has_trait = trait_syncretic_proles
						}
					}
					switch = {
						trigger = has_ethic
						# Vanilla
						ethic_authoritarian = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_authoritarian
							}
						}
						ethic_egalitarian = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_egalitarian
							}
						}
						ethic_xenophobe = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_xenophobe
							}
						}
						ethic_xenophile = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_xenophile
							}
						}
						ethic_militarist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_militarist
							}
						}
						ethic_pacifist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_pacifist
							}
						}
						ethic_spiritualist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_spiritualist
							}
						}
						ethic_materialist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_materialist
							}
						}
						# Evolved
						ethic_cooperative = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_cooperative
							}
						}
						ethic_competitive = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_competitive
							}
						}
						ethic_ecologist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_ecologist
							}
						}
						ethic_industrialist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_industrialist
							}
						}
						ethic_elitist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_elitist
							}
						}
						ethic_pluralist = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_pluralist
							}
						}
						# Gestalt
						ethic_gestalt_consciousness = {
							event_target:tec_temp_leader = {
								change_background_ethic = ethic_gestalt_consciousness
							}
						}
					}
				}
			}
			# Now that ethics have been changed...
			# Technically this event should trigger before extra traits
			# So lets nuke it
			remove_all_traits = yes
			set_variable = {
				which = var_level
				value = trigger:has_skill
			}
			change_variable = {
				which = var_level
				value = -1
			}
			set_skill = 1
			# Adds a new starting trait
			# (now weighted properly by non ghost ethics)
			add_trait_no_notify = "random_common"
			# Increases the skills equal to the level -1
			if = {
				limit = {
					check_variable = {
						which = var_level
						value > 0
					}
				}
				add_skill_without_trait_selection = var_level
			}
			# Lets clean it
			clear_variable = var_level
		}
	}
}